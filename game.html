<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AÅŸk Flappy ðŸ’–</title>

<style>
body{
    margin:0;
    background:#f8e6f0;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    overflow:hidden;
    font-family:Arial, sans-serif;
}

#gameContainer{
    position:relative;
}

canvas{
    background:linear-gradient(to top,#f9d6e5,#fff0f6);
    display:block;
    border-radius:12px;
}

#fullscreenBtn{
    position:absolute;
    top:10px;
    right:10px;
    padding:6px 12px;
    background:#ff69b4;
    color:white;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-size:14px;
}
</style>
</head>
<body>

<div id="gameContainer">
    <button id="fullscreenBtn">Tam Ekran</button>
    <canvas id="game"></canvas>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* ===== SABÄ°T ORAN ===== */
const BASE_WIDTH = 400;
const BASE_HEIGHT = 700;

function resizeGame(){
    let scale = Math.min(
        window.innerWidth / BASE_WIDTH,
        window.innerHeight / BASE_HEIGHT
    );
    canvas.width = BASE_WIDTH;
    canvas.height = BASE_HEIGHT;
    canvas.style.width = BASE_WIDTH * scale + "px";
    canvas.style.height = BASE_HEIGHT * scale + "px";
}
resizeGame();
window.addEventListener("resize", resizeGame);

/* ===== FÄ°ZÄ°K ===== */
const GRAVITY = 0.3025;
const JUMP = -6.2;
const MAX_FALL = 7;

let basePipeSpeed = 2.057;
let currentPipeSpeed = basePipeSpeed;

const PIPE_GAP = 195;
const PIPE_WIDTH = 60;
const PIPE_DISTANCE_PX = 260;   // ðŸ”¥ SABÄ°T YATAY MESAFE (piksel)

const GROUND_HEIGHT = 80;

let lastTime = 0;

/* ===== KUÅž ===== */
let bird = {
    x: 90,
    y: 350,
    radius: 18,
    velocity: 0,
    rotation: 0
};

/* ===== OYUN ===== */
let pipes = [];
let score = 0;
let bestScore = localStorage.getItem("bestScore") || 0;
let gameOver = false;

/* ===== TAM EKRAN ===== */
document.getElementById("fullscreenBtn").onclick = () => {
    if(!document.fullscreenElement){
        document.documentElement.requestFullscreen();
    } else {
        document.exitFullscreen();
    }
};

/* ===== KONTROL ===== */
function jump(){
    if(!gameOver){
        bird.velocity = JUMP;
        bird.rotation = -20;
    } else {
        restart();
    }
}

document.addEventListener("keydown", e=>{
    if(e.code==="Space") jump();
});
canvas.addEventListener("touchstart", jump);

/* ===== BORU OLUÅžTURMA (PÄ°KSEL TABANLI) ===== */
function createPipe(){
    let min = 80;
    let max = canvas.height - PIPE_GAP - GROUND_HEIGHT - 80;
    let topHeight = Math.random()*(max-min)+min;

    pipes.push({
        x: canvas.width,
        top: topHeight,
        passed:false
    });
}

/* ===== KUÅž ===== */
function drawBird(){
    ctx.save();
    ctx.translate(bird.x, bird.y);
    ctx.rotate(bird.rotation * Math.PI/180);

    ctx.fillStyle="#ffcc00";
    ctx.beginPath();
    ctx.arc(0,0,bird.radius,0,Math.PI*2);
    ctx.fill();

    ctx.fillStyle="white";
    ctx.beginPath();
    ctx.arc(6,-5,5,0,Math.PI*2);
    ctx.fill();

    ctx.fillStyle="black";
    ctx.beginPath();
    ctx.arc(7,-5,2,0,Math.PI*2);
    ctx.fill();

    ctx.fillStyle="orange";
    ctx.beginPath();
    ctx.moveTo(bird.radius, 0);
    ctx.lineTo(bird.radius+10, -4);
    ctx.lineTo(bird.radius+10, 4);
    ctx.closePath();
    ctx.fill();

    ctx.restore();
}

/* ===== BORULAR ===== */
function drawPipes(){
    pipes.forEach(pipe=>{
        ctx.fillStyle="#2ecc71";

        ctx.fillRect(pipe.x,0,PIPE_WIDTH,pipe.top);
        ctx.fillRect(pipe.x-5,pipe.top-20,PIPE_WIDTH+10,20);

        let bottomY = pipe.top + PIPE_GAP;
        let bottomHeight = canvas.height - bottomY - GROUND_HEIGHT;

        ctx.fillRect(pipe.x,bottomY,PIPE_WIDTH,bottomHeight);
        ctx.fillRect(pipe.x-5,bottomY,PIPE_WIDTH+10,20);
    });
}

/* ===== ZEMÄ°N ===== */
function drawGround(){
    ctx.fillStyle="#8b5a2b";
    ctx.fillRect(0,canvas.height-GROUND_HEIGHT,canvas.width,GROUND_HEIGHT);
}

/* ===== Ã‡ARPIÅžMA ===== */
function checkCollision(pipe){
    if(
        bird.x + bird.radius > pipe.x &&
        bird.x - bird.radius < pipe.x + PIPE_WIDTH
    ){
        if(
            bird.y - bird.radius < pipe.top ||
            bird.y + bird.radius > pipe.top + PIPE_GAP
        ){
            return true;
        }
    }
    return false;
}

/* ===== RESET ===== */
function restart(){
    bird.y = 350;
    bird.velocity = 0;
    bird.rotation = 0;
    pipes = [];
    score = 0;
    currentPipeSpeed = basePipeSpeed;
    gameOver = false;
}

/* ===== GAME LOOP ===== */
function update(timestamp){

    let deltaTime = (timestamp - lastTime) / 16.67;
    lastTime = timestamp;

    ctx.clearRect(0,0,canvas.width,canvas.height);

    /* === SABÄ°T MESAFE MANTIÄžI === */
    if(pipes.length === 0){
        createPipe();
    } else {
        let lastPipe = pipes[pipes.length-1];
        if(canvas.width - lastPipe.x >= PIPE_DISTANCE_PX){
            createPipe();
        }
    }

    if(!gameOver){

        bird.velocity += GRAVITY * deltaTime;
        if(bird.velocity > MAX_FALL) bird.velocity = MAX_FALL;
        bird.y += bird.velocity * deltaTime;

        if(bird.velocity > 0){
            bird.rotation += 3 * deltaTime;
            if(bird.rotation > 90) bird.rotation = 90;
        }
    }

    pipes.forEach(pipe=>{
        pipe.x -= currentPipeSpeed * deltaTime;

        if(!pipe.passed && pipe.x + PIPE_WIDTH < bird.x){
            score++;
            pipe.passed = true;

            currentPipeSpeed += 0.08; // hÄ±z artsÄ±n ama mesafe sabit kalsÄ±n
        }

        if(checkCollision(pipe)){
            gameOver = true;
        }
    });

    if(bird.y + bird.radius > canvas.height - GROUND_HEIGHT){
        gameOver = true;
    }

    drawPipes();
    drawGround();
    drawBird();

    ctx.fillStyle="#333";
    ctx.font="28px Arial";
    ctx.fillText("Skor: "+score,20,40);
    ctx.fillText("Rekor: "+bestScore,20,80);

    if(gameOver){
        if(score > bestScore){
            bestScore = score;
            localStorage.setItem("bestScore",bestScore);
        }

        ctx.fillStyle="rgba(0,0,0,0.4)";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        ctx.fillStyle="white";
        ctx.font="36px Arial";
        ctx.fillText("Oyun Bitti ðŸ’”",80,300);

        ctx.font="22px Arial";
        ctx.fillText("Tekrar baÅŸlamak iÃ§in dokun",60,350);
    }

    requestAnimationFrame(update);
}

requestAnimationFrame(update);
</script>

</body>
</html>
