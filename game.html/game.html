<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AÅŸk Flappy ðŸ’–</title>

<style>
body{
    margin:0;
    background:#f8e6f0;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    overflow:hidden;
    font-family:Arial, sans-serif;
}

#gameContainer{
    position:relative;
}

canvas{
    background:linear-gradient(to top,#f9d6e5,#fff0f6);
    display:block;
    border-radius:12px;
}

#fullscreenBtn{
    position:absolute;
    top:10px;
    right:10px;
    padding:6px 12px;
    background:#ff69b4;
    color:white;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-size:14px;
}
</style>
</head>
<body>

<div id="gameContainer">
    <button id="fullscreenBtn">Tam Ekran</button>
    <canvas id="game"></canvas>
</div>

<!-- SESLER -->
<audio id="bgMusic" src="bgmusic.mp3" loop></audio>
<audio id="pointSound" src="point.mp3"></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* ===== SABÄ°T ORAN ===== */
const BASE_WIDTH = 400;
const BASE_HEIGHT = 700;

function resizeGame(){
    let scale = Math.min(
        window.innerWidth / BASE_WIDTH,
        window.innerHeight / BASE_HEIGHT
    );
    canvas.width = BASE_WIDTH;
    canvas.height = BASE_HEIGHT;
    canvas.style.width = BASE_WIDTH * scale + "px";
    canvas.style.height = BASE_HEIGHT * scale + "px";
}
resizeGame();
window.addEventListener("resize", resizeGame);

/* ===== GÃœNCEL FÄ°ZÄ°K ===== */
const GRAVITY = 0.302;     // %10 daha arttÄ±
const JUMP = -6.2;
const MAX_FALL = 7;

const PIPE_SPEED = 2.06;  // %10 daha arttÄ±
const PIPE_GAP = 195;
const PIPE_DISTANCE = 150;

const GROUND_HEIGHT = 80;

/* ===== KUÅž ===== */
let bird = {
    x: 90,
    y: 350,
    radius: 18,
    velocity: 0
};

/* ===== OYUN ===== */
let pipes = [];
let frame = 0;
let score = 0;
let bestScore = localStorage.getItem("bestScore") || 0;
let gameOver = false;
let musicStarted = false;

/* ===== SES ===== */
const bgMusic = document.getElementById("bgMusic");
const pointSound = document.getElementById("pointSound");

/* ===== TAM EKRAN ===== */
document.getElementById("fullscreenBtn").onclick = () => {
    if(!document.fullscreenElement){
        document.documentElement.requestFullscreen();
    } else {
        document.exitFullscreen();
    }
};

/* ===== KONTROL ===== */
function jump(){
    if(!musicStarted){
        bgMusic.volume = 0.5;
        bgMusic.play();
        musicStarted = true;
    }

    if(!gameOver){
        bird.velocity = JUMP;
    } else {
        restart();
    }
}

document.addEventListener("keydown", e=>{
    if(e.code==="Space") jump();
});
canvas.addEventListener("touchstart", jump);

/* ===== BORU OLUÅžTUR ===== */
function createPipe(){
    let min = 80;
    let max = canvas.height - PIPE_GAP - GROUND_HEIGHT - 80;
    let topHeight = Math.random()*(max-min)+min;
    pipes.push({
        x: canvas.width,
        top: topHeight,
        passed:false
    });
}

/* ===== KUÅž ===== */
function drawBird(){
    ctx.fillStyle="#ffcc00";
    ctx.beginPath();
    ctx.arc(bird.x,bird.y,bird.radius,0,Math.PI*2);
    ctx.fill();

    ctx.fillStyle="white";
    ctx.beginPath();
    ctx.arc(bird.x+6,bird.y-5,5,0,Math.PI*2);
    ctx.fill();

    ctx.fillStyle="black";
    ctx.beginPath();
    ctx.arc(bird.x+7,bird.y-5,2,0,Math.PI*2);
    ctx.fill();

    ctx.fillStyle="orange";
    ctx.beginPath();
    ctx.moveTo(bird.x+bird.radius, bird.y);
    ctx.lineTo(bird.x+bird.radius+10, bird.y-4);
    ctx.lineTo(bird.x+bird.radius+10, bird.y+4);
    ctx.closePath();
    ctx.fill();
}

/* ===== BORULAR ===== */
function drawPipes(){
    pipes.forEach(pipe=>{
        ctx.fillStyle="#2ecc71";

        ctx.fillRect(pipe.x,0,60,pipe.top);
        ctx.fillRect(pipe.x-5,pipe.top-20,70,20);

        let bottomY = pipe.top + PIPE_GAP;
        let bottomHeight = canvas.height - bottomY - GROUND_HEIGHT;

        ctx.fillRect(pipe.x,bottomY,60,bottomHeight);
        ctx.fillRect(pipe.x-5,bottomY,70,20);
    });
}

/* ===== ZEMÄ°N ===== */
function drawGround(){
    ctx.fillStyle="#8b5a2b";
    ctx.fillRect(0,canvas.height-GROUND_HEIGHT,canvas.width,GROUND_HEIGHT);
}

/* ===== Ã‡ARPIÅžMA ===== */
function checkCollision(pipe){
    if(
        bird.x + bird.radius > pipe.x &&
        bird.x - bird.radius < pipe.x + 60
    ){
        if(
            bird.y - bird.radius < pipe.top ||
            bird.y + bird.radius > pipe.top + PIPE_GAP
        ){
            return true;
        }
    }
    return false;
}

/* ===== RESET ===== */
function restart(){
    bird.y = 350;
    bird.velocity = 0;
    pipes = [];
    score = 0;
    frame = 0;
    gameOver = false;
}

/* ===== GAME LOOP ===== */
function update(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    frame++;

    if(frame % PIPE_DISTANCE === 0){
        createPipe();
    }

    if(!gameOver){
        bird.velocity += GRAVITY;
        if(bird.velocity > MAX_FALL) bird.velocity = MAX_FALL;
        bird.y += bird.velocity;
    }

    pipes.forEach(pipe=>{
        pipe.x -= PIPE_SPEED;

        if(!pipe.passed && pipe.x + 60 < bird.x){
            score++;
            pipe.passed = true;

            pointSound.currentTime = 0;
            pointSound.play();
        }

        if(checkCollision(pipe)){
            gameOver = true;
        }
    });

    if(bird.y + bird.radius > canvas.height - GROUND_HEIGHT){
        gameOver = true;
    }

    drawPipes();
    drawGround();
    drawBird();

    ctx.fillStyle="#333";
    ctx.font="28px Arial";
    ctx.fillText("Skor: "+score,20,40);
    ctx.fillText("Rekor: "+bestScore,20,80);

    requestAnimationFrame(update);
}

update();
</script>

</body>
</html>
